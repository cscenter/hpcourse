# Высокопроизводительный сервер задач

Реализуйте высокопроизводительный многопоточный сервер для выполнения CPU-intensive задач. 

Задачи которые будет решать сервер:
```cpp
int64_t task(int64_t a, int64_t b, int64_t p, int64_t m, int64_t n) 
{
  while (n-- > 0) 
  {
    b = (a * p + b) % m;
    a = b;
  }
  return a;
}
```

Сервер должен уметь принимать клиентсткие запросы в виде [Google Protocol Buffers][protobuf] сообщений в соответствии с описанным протоколом.

[Описание протокола][protocol].
* Клиент общается с сервером посредством сообщений ServerRequest 
* Cервер отвечает сообщениями ServerResponse.

Протокол поддерживает 3 типа запросов:
1. Запустить задачу на выполнение
2. Подписаться на результат уже запущенной задачи
3. Посмотреть список выполняющихся задач

При запросе на запуск задачи, сервер должен присвоить этой задаче уникальный идентификатор, запустить задачу на выполнение, если она не содержит зависимых переменных и отправить клиенту сообщение с признаком успешного запуска задачи и ее идентификатором если она запущена успешно. Если задача содержит зависимые переменные, то задачу нужно придержать до тех пор, пока все зависимые задачи не закончат свое выполнение, присвоить значения всех зависимых переменных, результатами задач, и запустить ее. Предполагается, что вы будете релизовывать этот механизм через Wait/Notify или conditional_variable.

При запросе на подписку результата задачи, сервер должен вернуть результат немедленно если задача с заданным идентификатором уже выполнена, или если же задача запущена, вернуть ее результат после ее выполнения.

При запросе списка задач, сервер должен вернуть описания всех задач запущенных на сервере а также уже выполненных задач.

Диалог клиента с сервером, например, может выглядеть таким образом.
![Пример последовательности сообщений](https://s9.postimg.org/mul715667/Task+Server.png "Пример последовательности сообщений")

Дополнительные замечания:
1. Не разрешается использовать инструменты уровня абстракции выше потоков (java.util.concurrent и подобных).
2. На языки ограничений нет :)
3. Приложение должно быть горизонтально масштабируемым (если запускаем на более производительной машине - то и прирост должен быть почти кратный для независимых задач)

При возникновении любых вопросов не стесняйтесь писать нам на почту. Пожалуйста указывайте в теме письма "HPC Имя Фамилия", тем самым вы уменьшите время ответа.
eduard.eduardov@jetbrains.com

Удачи!

   [protobuf]: <https://developers.google.com/protocol-buffers/>
   [protocol]: <https://gist.github.com/EduardovEduard/bbe125f1e8ec305a1784>



